---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.20.0
  name: authenticationfilters.gateway.nginx.org
spec:
  group: gateway.nginx.org
  names:
    categories:
    - nginx-gateway-fabric
    kind: AuthenticationFilter
    listKind: AuthenticationFilterList
    plural: authenticationfilters
    shortNames:
    - authfilter
    - authenticationfilter
    singular: authenticationfilter
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: |-
          AuthenticationFilter configures request authentication and is
          referenced by HTTPRoute and GRPCRoute filters using ExtensionRef.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Spec defines the desired state of the AuthenticationFilter.
            properties:
              basic:
                description: Basic configures HTTP Basic Authentication.
                properties:
                  realm:
                    description: |-
                      Realm used by NGINX `auth_basic` directive.
                      https://nginx.org/en/docs/http/ngx_http_auth_basic_module.html#auth_basic
                      Also configures "realm="<realm_value>" in WWW-Authenticate header in error page location.
                    type: string
                  secretRef:
                    description: SecretRef allows referencing a Secret in the same
                      namespace.
                    properties:
                      name:
                        description: Name is the referenced object.
                        type: string
                    required:
                    - name
                    type: object
                required:
                - realm
                - secretRef
                type: object
              jwt:
                description: |-
                  JWT configures JSON Web Token authentication (NGINX Plus).
                  Required when Type == JWT.
                properties:
                  file:
                    description: |-
                      File specifies local JWKS configuration.
                      Required when Mode == File.
                    properties:
                      keyCache:
                        description: |-
                          KeyCache is the cache duration for keys.
                          Configures `auth_jwt_key_cache` directive.
                          https://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_key_cache
                          Example: "auth_jwt_key_cache 10m;".
                        pattern: ^[0-9]{1,4}(ms|s|m|h)?$
                        type: string
                      secretRef:
                        description: SecretRef references a Secret containing the
                          JWKS.
                        properties:
                          name:
                            description: Name is the referenced object.
                            type: string
                        required:
                        - name
                        type: object
                    required:
                    - secretRef
                    type: object
                  keyCache:
                    description: |-
                      KeyCache is the cache duration for keys.
                      Configures auth_jwt_key_cache directive.
                      https://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_key_cache
                      Example: "auth_jwt_key_cache 10m".
                    pattern: ^[0-9]{1,4}(ms|s|m|h)?$
                    type: string
                  leeway:
                    description: |-
                      Leeway is the acceptable clock skew for exp/nbf checks.
                      Configures `auth_jwt_leeway` directive.
                      https://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_leeway
                      Example: "auth_jwt_leeway 60s".
                    pattern: ^[0-9]{1,4}(ms|s|m|h)?$
                    type: string
                  mode:
                    description: 'Mode selects how JWT keys are provided: local file
                      or remote JWKS.'
                    enum:
                    - File
                    - Remote
                    type: string
                  realm:
                    description: |-
                      Realm used by NGINX `auth_jwt` directive
                      https://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt
                      Configures "realm="<realm_value>" in WWW-Authenticate header in error page location.
                    type: string
                  remote:
                    description: |-
                      Remote specifies remote JWKS configuration.
                      Required when Mode == Remote.
                    properties:
                      cache:
                        description: |-
                          Cache configures NGINX proxy_cache for JWKS fetches made via auth_jwt_key_request.
                          When set, NGF will render proxy_cache_path in http{} and attach proxy_cache to the internal JWKS location.
                        properties:
                          inactive:
                            description: Inactive defines the inactivity timeout before
                              cached items are evicted (e.g. "10m").
                            type: string
                          keysZoneName:
                            description: |-
                              KeysZoneName is the name of the cache keys zone.
                              If omitted, the controller SHOULD derive a unique, stable name per filter instance.
                            type: string
                          keysZoneSize:
                            description: |-
                              KeysZoneSize is the size of the cache keys zone (e.g. "10m").
                              This is required to avoid unbounded allocations.
                            type: string
                          levels:
                            description: |-
                              Levels specifies the directory hierarchy for cached files.
                              Used in `proxy_cache_path` directive.
                              https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache_path
                              Example: "levels=1:2".
                            type: string
                          maxSize:
                            description: MaxSize limits the total size of the cache
                              (e.g. "50m").
                            type: string
                          useTempPath:
                            description: |-
                              UseTempPath controls whether a temporary file is used for cache writes.
                              Maps to use_temp_path=(on|off). Default: false (off).
                            type: boolean
                        required:
                        - keysZoneSize
                        type: object
                      url:
                        description: URL is the JWKS endpoint, e.g. "https://issuer.example.com/.well-known/jwks.json".
                        type: string
                    required:
                    - url
                    type: object
                  type:
                    default: signed
                    description: |-
                      Type sets token type: signed | encrypted | nested.
                      Default: signed.
                      Configures `auth_jwt_type` directive.
                      https://nginx.org/en/docs/http/ngx_http_auth_jwt_module.html#auth_jwt_type
                      Example: "auth_jwt_type signed;".
                    enum:
                    - signed
                    - encrypted
                    - nested
                    type: string
                required:
                - mode
                - realm
                type: object
                x-kubernetes-validations:
                - message: mode File requires spec.file to be set.
                  rule: self.mode != 'File' || has(self.file)
                - message: mode Remote requires spec.remote to be set.
                  rule: self.mode != 'Remote' || has(self.remote)
              type:
                description: Type selects the authentication mechanism.
                enum:
                - Basic
                - JWT
                type: string
            required:
            - type
            type: object
            x-kubernetes-validations:
            - message: type Basic requires spec.basic to be set.
              rule: self.type != 'Basic' || has(self.basic)
            - message: type JWT requires spec.jwt to be set.
              rule: self.type != 'JWT' || has(self.jwt)
          status:
            description: Status defines the state of the AuthenticationFilter.
            properties:
              controllers:
                description: |-
                  Controllers is a list of Gateway API controllers that processed the AuthenticationFilter
                  and the status of the AuthenticationFilter with respect to each controller.
                items:
                  properties:
                    conditions:
                      description: Conditions describe the status of the SnippetsFilter.
                      items:
                        description: Condition contains details for one aspect of
                          the current state of this API Resource.
                        properties:
                          lastTransitionTime:
                            description: |-
                              lastTransitionTime is the last time the condition transitioned from one status to another.
                              This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                            format: date-time
                            type: string
                          message:
                            description: |-
                              message is a human readable message indicating details about the transition.
                              This may be an empty string.
                            maxLength: 32768
                            type: string
                          observedGeneration:
                            description: |-
                              observedGeneration represents the .metadata.generation that the condition was set based upon.
                              For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                              with respect to the current state of the instance.
                            format: int64
                            minimum: 0
                            type: integer
                          reason:
                            description: |-
                              reason contains a programmatic identifier indicating the reason for the condition's last transition.
                              Producers of specific condition types may define expected values and meanings for this field,
                              and whether the values are considered a guaranteed API.
                              The value should be a CamelCase string.
                              This field may not be empty.
                            maxLength: 1024
                            minLength: 1
                            pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                            type: string
                          status:
                            description: status of the condition, one of True, False,
                              Unknown.
                            enum:
                            - "True"
                            - "False"
                            - Unknown
                            type: string
                          type:
                            description: type of condition in CamelCase or in foo.example.com/CamelCase.
                            maxLength: 316
                            pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                            type: string
                        required:
                        - lastTransitionTime
                        - message
                        - reason
                        - status
                        - type
                        type: object
                      maxItems: 8
                      minItems: 1
                      type: array
                      x-kubernetes-list-map-keys:
                      - type
                      x-kubernetes-list-type: map
                    controllerName:
                      description: |-
                        ControllerName is a domain/path string that indicates the name of the
                        controller that wrote this status. This corresponds with the
                        controllerName field on GatewayClass.

                        Example: "example.net/gateway-controller".

                        The format of this field is DOMAIN "/" PATH, where DOMAIN and PATH are
                        valid Kubernetes names
                        (https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names).

                        Controllers MUST populate this field when writing status. Controllers should ensure that
                        entries to status populated with their ControllerName are cleaned up when they are no
                        longer necessary.
                      maxLength: 253
                      minLength: 1
                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*\/[A-Za-z0-9\/\-._~%!$&'()*+,;=:]+$
                      type: string
                  required:
                  - controllerName
                  type: object
                maxItems: 16
                type: array
            type: object
        required:
        - metadata
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
